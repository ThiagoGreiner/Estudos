# Gerenciadores de Pacotes

Gerenciadores de pacotes, tambem chamados de gerenciadores de depêndencias são ferramentas utilizadas para colocar e gerenciar bibliotecas dentro de um projeto.
Neste caso veremos sobre o composer.

### Onde Buscar Dependências do Composer

Podemos buscar dependências tanto no GitHub como no Packagist.

No caso do [Packagist](https://packagist.org/) podemos usar a barra de pesquisa dentro do site para encontrar oque precisamos. Por exemplo se precisar de um gerador de PDF para utilizar no projeto, pode se buscar na barra de pesquisa utilizando uma palavra chave (PDF).

Após encontrar o conteudo desejado, basta acessar e seguir o passo a passo de utilização.

Todas as bibliotecas disponiveis tem um ``USO``, onde possui algumas informações de uso basico daquela biblioteca.

## Composer

abaixo veremos os comando utilizos para iniciar um projeto e para incluir dependências em um projeto.

### Comando Composer Init 

Ao rodar esse comando no CMD ele ira iniciar um projeto com composer e retornar algumas perguntas:

* Packge name = Informamos um nome para o projeto, se deixar em branco ele ira puxar o nome padrão que aparece entre ``[ ]``.
    
* Description = Informamos um breve descrição do projeto.

* Autor = Geralmente ele puxa automático, aparece entre ``[ ]``.

* Minimun Stability = Deixar em branco.

* Package Type = Geralmente utilizamos projeto (project).

* License = Deixar em branco.

* Irá utilizar/buscar alguma dependência para o projeto = Yes ou no.

Após todas as perguntas respondidas, o projeto sera gerado semelhante ao seguinte exemplo.

```json
{
    "name": "app/composerphp",
    "description": "Estudando Composer",
    "type": "project",
    // Chave autoload
    "autoload": {
        // psr-4 representa uma recomendação de padrões dentro da comunidade PHP 
        "psr-4": {
            // Declaração do namespace (como se fosse o nome de um diretório, neste exemplo usaremos o nome App), seguido do local (diretório src)
            "App": "src/"
        }
    },
    "authors": [
        {
            "name": "Thiago Greiner",
            "email": "thiagogreiner0@gmail.com"
        }
    ],
    //Em require declaramos as dependencias(bibliotecas) que serão utilizadas no projeto
    "require": {},

    //Utilizado no desenvolvimento do projeto, como dependencias para realizar testes unitarios
    "require-dev": {}
}
```

### Comando composer required

Serve para localizar dependências e instalar elas em um projeto.

Para instalar a dependência basta rodar o comando ``composer require`` no CMD e informar o nome da dependência que deseja utilizar,neste exemplo o nome da dependência seria ``mpdf/mpdf``, então o comando ficaria desta forma ``composer require mpdf/mpdf``.

Após rodar o comando a dependência aparecera em ``require``.

Outra maneira de instalar estas dependências é declarar manualmente dentro do ``require`` conforme exemplo.

```json
"require": {
        "mpdf/mpdf": "^6.1"
}
```

Depois basta rodar o comando  ``composer install`` no CMD, assim sera instalado todas as dependências declaradas.

### Comando Composer update

Serve para a atualizar as versões das dependências instaladas no projeto.

> [!WARNING]
> Importante lembrar que esta atualização tambem ira atualizar o composer Lock, e podera causar quebra no código.

### Comando Composer remove

Este comando serve para remover dependências já instaladas no projeto, para isso basta rodas o comando ``composer remove`` no CMD seguido do nome da dependência, digamos que seja a mesma usada anteriormente ``mpdf/mpdf``, então bastaria rodar o comando ``composer remove mpdf/mpdf``.

### Namespace (Chave Autoload)

No PHP (e em várias linguagens), namespace é uma forma de organizar e agrupar classes, funções e constantes para evitar conflitos de nomes dentro de um projeto.

Pensamos nele como pastas virtuais dentro do código.

Imagina que estamos usando duas bibliotecas diferentes e ambas têm uma classe chamada Usuario.

Sem namespaces, o PHP não saberia qual das duas usar, isso gera conflito de nomes.

Com namespaces, você pode organizar assim:

* App\Models\Usuario

* App\Controllers\Usuario

Ex Models:

Neste exemplo o código estaria na pasta src ``src/Models/Usuario.php``, onde criamos as classes.

```php
<?php
    namespace App\Models;

    class Usuario {
        public function mostrar() {
            echo "Eu sou um usuário do Model";
        }
    }
?>
```

Ex Controllers:

Neste exemplo o código estaria na pasta src ``src/Controllers/Usuario.php``, onde criamos as classes.

```php
<?php
    namespace App\Controllers;

    class Usuario {
        public function mostrar() {
            echo "Eu sou um usuário do Controller";
        }
    }
?>
```

Já no arquivo principal(index) é onde usamos o ``require`` para chamar as classes criadas acima. 

```php
<?php
    require 'vendor/autoload.php';

    $model = new App\Models\Usuario();
    $model->mostrar(); // Eu sou um usuário do Model

    $controller = new App\Controllers\Usuario();
    $controller->mostrar(); // Eu sou um usuário do Controller
?>
```

Abaixo veremos mais sobre o comando ``require``, uma outra forma de realizar a declaração apenas uma vez.

para evitar toda aquela declaração que fizemos após os news do exemplo acima, podemos utilizar o comando ``use``, assim tambem facilita na hora de criar objetos.

```php
<?php
    use App\Models\Usuario;

    $model = new Usuario();
?>
```

Para casos com classes que possuem o mesmo nome, dai então podemos utilizar apelidos que devem ser declarados utilizando o ``as``.

```php
<?php
    require 'vendor/autoload.php';

    use App\Models\Usuario as UsuarioModel;
    use App\Controllers\Usuario as UsuarioController;

    $model = new UsuarioModel();
    $controller = new UsuarioController();
?>
```

Resumidamente a declaração final ficaria desta forma.

```php
<?php
    use App\Models\Usuario as UsuarioModel;
    use App\Controllers\Usuario as UsuarioController;

    $model = new UsuarioModel();
    $controller = new UsuarioController();
?>
```

> [!WARNING]
> Após criar novas classes precisamos rodar o comando ``composer dump-autoload`` para que o arquivo se atualize.

## Arquivo Composer Lock

Neste arquivo são armazenados as versões de todas dependências que estão sendo utilizadas no projeto, isto evita que se pessoas diferentes trabalhem com versões diferentes dentro de um mesmo projetos, oque poderia causar quebras no código.

## Pasta Vendor

Neste pasta ficaram todos os arquivos que o composer utiliza e tambem os arquivos utilizados pelas dependências que estão sendo utilizadas no projeto.

## Arquivo autoload

Este arquivo faz o mapeamento de todas dependências que foram instaladas no projeto via composer, assim não temos necessidade declarar um ``require`` para cada dependência instalada, basta declarar uma unica vez o require abaixo.

```php
require __DIR__ . '/vendor/autoload.php';

```

> [!WARNING]
> O caminho ``'/vendor/autoload.php'`` pode se alterar conforme o local dos arquivos dentro do projeto.